{-# LANGUAGE RebindableSyntax #-}
module Main (main) where

import Control.Monad (forM_)
import Control.Monad.FD
import Criterion.Main

import Data.Traversable (forM)

import Prelude hiding (Num (..), max, min)

eq20 :: IO [[Int]]
eq20 = runFDT $ do
  x1 <- freshTerm
  x2 <- freshTerm
  x3 <- freshTerm
  x4 <- freshTerm
  x5 <- freshTerm
  x6 <- freshTerm
  x7 <- freshTerm
  let xs = [x1, x2, x3, x4, x5, x6, x7]
  forM_ xs $ \ x -> do
    x #>= 0
    x #<= 10

  876370 + 16105 * x1 + 6704 * x3 + 68610 * x6
    #= 0 + 62397 * x2 + 43340 * x4 + 95100 * x5 + 58301 * x7

  533909 + 96722 * x5
    #= 0 + 51637 * x1 + 67761 * x2 + 95951 * x3 + 3834 * x4 + 59190 * x6 + 15280 * x7

  915683 + 34121 * x2 + 33488 * x7
    #= 0 + 1671 * x1 + 10763 * x3 + 80609 * x4 + 42532 * x5 + 93520 * x6

  129768 + 11119 * x2 + 38875 * x4 + 14413 * x5 + 29234 * x6
    #= 0 + 71202 * x1 + 73017 * x3 + 72370 * x7

  752447 + 58412 * x2
    #= 0 + 8874 * x1 + 73947 * x3 + 17147 * x4 + 62335 * x5 + 16005 * x6 + 8632 * x7

  90614 + 18810 * x3 + 48219 * x4 + 79785 * x7
    #= 0 + 85268 * x1 + 54180 * x2 + 6013 * x5 + 78169 * x6

  1198280 + 45086 * x1 + 4578 * x3
    #= 0 + 51830 * x2 + 96120 * x4 + 21231 * x5 + 97919 * x6 + 65651 * x7

  18465 + 64919 * x1 + 59624 * x4 + 75542 * x5 + 47935 * x7
    #= 0 + 80460 * x2 + 90840 * x3 + 25145 * x6

  0 + 43525 * x2 + 92298 * x3 + 58630 * x4 + 92590 * x5
    #= 1503588 + 43277 * x1 + 9372 * x6 + 60227 * x7

  0 + 47385 * x2 + 97715 * x3 + 69028 * x5 + 76212 * x6
    #= 1244857 + 16835 * x1 + 12640 * x4 + 81102 * x7

  0 + 31227 * x2 + 93951 * x3 + 73889 * x4 + 81526 * x5 + 68026 * x7
    #= 1410723 + 60301 * x1 + 72702 * x6

  0 + 94016 * x1 + 35961 * x3 + 66597 * x4
    #= 25334 + 82071 * x2 + 30705 * x5 + 44404 * x6 + 38304 * x7

  0 + 84750 * x2 + 21239 * x4 + 81675 * x5
    #= 277271 + 67456 * x1 + 51553 * x3 + 99395 * x6 + 4254 * x7

  0 + 29958 * x2 + 57308 * x3 + 48789 * x4 + 4657 * x6 + 34539 * x7
    #= 249912 + 85698 * x1 + 78219 * x5

  0 + 85176 * x1 + 57898 * x4 + 15883 * x5 + 50547 * x6 + 83287 * x7
    #= 373854 + 95332 * x2 + 1268 * x3

  0 + 87758 * x2 + 19346 * x4 + 70072 * x5 + 44529 * x7
    #= 740061 + 10343 * x1 + 11782 * x3 + 36991 * x6

  0 + 49149 * x1 + 52871 * x2 + 56728 * x4
    #= 146074 + 7132 * x3 + 33576 * x5 + 49530 * x6 + 62089 * x7

  0 + 29475 * x2 + 34421 * x3 + 62646 * x5 + 29278 * x6
    #= 251591 + 60113 * x1 + 76870 * x4 + 15212 * x7

  22167 + 29101 * x2 + 5513 * x3 + 21219 * x4
    #= 0 + 87059 * x1 + 22128 * x5 + 7276 * x6 + 57308 * x7

  821228 + 76706 * x1 + 48614 * x6 + 41906 * x7
    #= 0 + 98205 * x2 + 23445 * x3 + 67921 * x4 + 24111 * x5

  forM xs label

main :: IO ()
main = defaultMain [bench "eq20" $ nfIO eq20]
